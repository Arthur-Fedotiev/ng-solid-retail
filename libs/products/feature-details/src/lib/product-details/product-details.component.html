<mat-card
  fxLayout="column nowrap"
  fxLayoutAlign="start center"
  fxLayoutGap="3rem"
  class="product-card"
  role="region"
>
  <mat-card-header>
    <mat-card-title>
      <h1 class="mat-headline">{{ product.name }}</h1>
    </mat-card-title>
  </mat-card-header>
  <img
    class="product-card__photo"
    mat-card-image
    src="https://m.media-amazon.com/images/I/711eKF9vJuL._AC_UY695_.jpg"
    alt="Photo of a {{ product.name }}"
  />
  <mat-card-content class="product-card__content">
    <h3 class="mat-title">Description</h3>
    <p>
      {{ product.description }}
    </p>

    <h3 class="mat-title">Lowest Tier 1 price</h3>
    <p>
      <span *ngIf="product.prices | omniaLowestTierPrice as lowestPrice">{{
        lowestPrice ? lowestPrice + '$' : 'N/A'
      }}</span>
    </p>

    <h3 class="mat-title">Prices by retailers</h3>

    <div *ngFor="let price of product.prices">
      <h4 class="mat-subheading-2">
        <span class="mat-body-strong">
          {{ price.retailer.name }} - {{ price.price }}$
        </span>
        <span class="mat-body">
          (Tier: {{ price.tier }}, last updated:
          {{ price.updateTime | date: 'medium' }})
        </span>

        <mat-form-field appearance="outline">
          <mat-label>Price</mat-label>
          <input
            placeholder="Price"
            matInput
            [value]="price.price"
            [(ngModel)]="price.price"
          /> </mat-form-field
        ><button mat-mini-fab>
          <mat-icon>edit</mat-icon>
        </button>
      </h4>
    </div>
  </mat-card-content>
  <mat-card-actions>
    <button class="prices__action" mat-raised-button color="primary">
      EDIT EXERCISE
    </button>
    <button class="prices__action" mat-raised-button color="warn">
      DELETE EXERCISE
    </button>
  </mat-card-actions>
</mat-card>

<ng-template #priceTpl let-state let-isEdit="isEdit">
  <h4 class="mat-subheading-2">
    <ng-container *ngIf="!isEdit; else editTpl">
      <span class="mat-body-strong">
        {{ state.retailer.name }} - {{ state.price }}$
      </span>
      <span class="mat-body">
        (Tier: {{ state.tier }}, last updated:
        {{ state.updateTime | date: 'medium' }})
      </span>
    </ng-container>

    <ng-template #editTpl
      ><mat-form-field appearance="outline">
        <mat-label>Price</mat-label>
        <input
          placeholder="Price"
          matInput
          [value]="state.price"
          [(ngModel)]="state.price"
        /> </mat-form-field
    ></ng-template>
  </h4>
</ng-template>

<pre> {{ product.prices | json }} </pre>
