<mat-card
  *ngIf="product$ | async as product"
  fxLayout="column nowrap"
  fxLayoutAlign="start center"
  fxLayoutGap="3rem"
  class="product-card"
  role="region"
>
  <mat-card-header>
    <mat-card-title>
      <h1 class="mat-headline">{{ product.name }}</h1>
    </mat-card-title>
  </mat-card-header>
  <img
    class="product-card__photo"
    mat-card-image
    src="{{ product.url }}"
    alt="Photo of a {{ product.name }}"
  />
  <mat-card-content class="product-card__content">
    <h3 class="mat-title">Description</h3>
    <p>
      {{ product.description }}
    </p>

    <h3 class="mat-title">Lowest Tier 1 price</h3>
    <p>
      <span *ngIf="product.prices | omniaLowestTierPrice as lowestPrice">{{
        lowestPrice ? lowestPrice + '$' : 'N/A'
      }}</span>
    </p>

    <h3 class="mat-title">Categories</h3>

    <ng-container
      *ngFor="
        let category of product.categories;
        index as i;
        trackBy: trackById
      "
    >
      <button
        mat-raised-button
        matTooltip="Info about all competitors for the category"
        class="subheading-2"
        aria-label="Button that displays a tooltip when focused or hovered over"
        (click)="openCompetitorsDialog(category)"
      >
        {{ category.name }}
      </button>
    </ng-container>

    <h3 class="mat-title">Prices by retailers</h3>

    <div *ngFor="let price of product.prices; trackBy: trackById">
      <omnia-product-price
        #productPrice="omniaProductPrice"
        [price]="price"
        (save)="updateProductPrice(product, $event)"
      >
        <button action mat-mini-fab color="primary">
          <mat-icon>edit</mat-icon>
        </button></omnia-product-price
      >
    </div>
  </mat-card-content>
  <mat-card-actions>
    <button
      class="prices__action"
      mat-raised-button
      color="warn"
      (click)="deleteProduct(product.id)"
    >
      DELETE PRODUCT
    </button>
  </mat-card-actions>
</mat-card>
